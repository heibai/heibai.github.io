<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>heibai&#39;s blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="heibai.site/"/>
  <updated>2019-03-22T18:25:45.235Z</updated>
  <id>heibai.site/</id>
  
  <author>
    <name>heibai</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Nginx之负载均衡</title>
    <link href="heibai.site/2018/12/31/Nginx%E4%B9%8B%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
    <id>heibai.site/2018/12/31/Nginx之负载均衡/</id>
    <published>2018-12-31T07:04:17.000Z</published>
    <updated>2019-03-22T18:25:45.235Z</updated>
    
    <content type="html"><![CDATA[<h5 id="概要："><a href="#概要：" class="headerlink" title="概要："></a>概要：</h5><p>​    随着公司项目越来越大，流量也跟着越来越大，为了避免发生单点故障和系统的高性能，越来越多的网站架构都使用了负载均衡技术，这里简单记录一下Nginx负载均衡的配置方式。</p><h5 id="什么是负载均衡"><a href="#什么是负载均衡" class="headerlink" title="什么是负载均衡"></a>什么是负载均衡</h5><p>   负载均衡是由多台服务器以对称的方式组成一个服务器集合，每台服务器都具有等价的地位，都可以单独对外提供服务而无须其他服务器的辅助。通过某种负载分担技术，将外部发送来的请求均匀分配到对称结构中的某一台服务器上，而接收到请求的服务器独立地回应客户的请求。均衡负载能够平均分配客户请求到服务器列阵，籍此提供快速获取重要数据，解决大量并发访问服务问题。这种<a href="https://baike.baidu.com/item/%E7%BE%A4%E9%9B%86%E6%8A%80%E6%9C%AF" target="_blank" rel="noopener">群集技术</a>可以用最少的投资获得接近于大型主机的性能。</p>   <a id="more"></a><h5 id="Nginx配置"><a href="#Nginx配置" class="headerlink" title="Nginx配置"></a>Nginx配置</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line">user  www; #使用www用户</span><br><span class="line">worker_processes  4;</span><br><span class="line"></span><br><span class="line">error_log  logs/error.log;</span><br><span class="line">error_log  logs/error.log  notice;</span><br><span class="line">error_log  logs/error.log  info;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">pid        logs/nginx.pid;</span></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    #log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span><br><span class="line">    #                  '$status $body_bytes_sent "$http_referer" '</span><br><span class="line">    #                  '"$http_user_agent" "$http_x_forwarded_for"';</span><br><span class="line"></span><br><span class="line"><span class="meta">   #</span><span class="bash"> access_log  logs/access.log  main;</span></span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    #gzip  on;</span><br><span class="line">    </span><br><span class="line">    #负载均衡池，使用ip_hash保持会话的一致性</span><br><span class="line">     upstream jar_pool&#123;</span><br><span class="line">         ip_hash;</span><br><span class="line">         server 192.168.11.9:8080;</span><br><span class="line">         server 192.168.11.10:8080;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    #监听本地80端口</span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line"></span><br><span class="line">        #location / &#123;</span><br><span class="line">        #    root   html;</span><br><span class="line">        #    index  index.html index.htm;</span><br><span class="line">        # &#125;</span><br><span class="line">      #把所有转发到后端的负载均衡池</span><br><span class="line">        location / &#123;</span><br><span class="line">        proxy_set_header Host $host:$server_port;</span><br><span class="line">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        proxy_pass http://jar_pool;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        #error_page  404              /404.html;</span><br><span class="line"></span><br><span class="line">        # redirect server error pages to the static page /50x.html</span><br><span class="line">        #</span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">       # location = /50x.html &#123;</span><br><span class="line">       #     root   html;</span><br><span class="line">       # &#125;</span><br><span class="line"></span><br><span class="line">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    proxy_pass   http://127.0.0.1;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    root           html;</span><br><span class="line">        #    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">        #    fastcgi_index  index.php;</span><br><span class="line">        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">        #    include        fastcgi_params;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        # deny access to .htaccess files, if Apache's document root</span><br><span class="line">        # concurs with nginx's one</span><br><span class="line">        #</span><br><span class="line">        #location ~ /\.ht &#123;</span><br><span class="line">        #    deny  all;</span><br><span class="line">        #&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       8000;</span><br><span class="line">    #    listen       somename:8080;</span><br><span class="line">    #    server_name  somename  alias  another.alias;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # HTTPS server</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       443 ssl;</span><br><span class="line">    #    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    #    ssl_certificate      cert.pem;</span><br><span class="line">    #    ssl_certificate_key  cert.key;</span><br><span class="line"></span><br><span class="line">    #    ssl_session_cache    shared:SSL:1m;</span><br><span class="line">    #    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    #    ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;概要：&quot;&gt;&lt;a href=&quot;#概要：&quot; class=&quot;headerlink&quot; title=&quot;概要：&quot;&gt;&lt;/a&gt;概要：&lt;/h5&gt;&lt;p&gt;​    随着公司项目越来越大，流量也跟着越来越大，为了避免发生单点故障和系统的高性能，越来越多的网站架构都使用了负载均衡技术，这里简单记录一下Nginx负载均衡的配置方式。&lt;/p&gt;
&lt;h5 id=&quot;什么是负载均衡&quot;&gt;&lt;a href=&quot;#什么是负载均衡&quot; class=&quot;headerlink&quot; title=&quot;什么是负载均衡&quot;&gt;&lt;/a&gt;什么是负载均衡&lt;/h5&gt;&lt;p&gt;   负载均衡是由多台服务器以对称的方式组成一个服务器集合，每台服务器都具有等价的地位，都可以单独对外提供服务而无须其他服务器的辅助。通过某种负载分担技术，将外部发送来的请求均匀分配到对称结构中的某一台服务器上，而接收到请求的服务器独立地回应客户的请求。均衡负载能够平均分配客户请求到服务器列阵，籍此提供快速获取重要数据，解决大量并发访问服务问题。这种&lt;a href=&quot;https://baike.baidu.com/item/%E7%BE%A4%E9%9B%86%E6%8A%80%E6%9C%AF&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;群集技术&lt;/a&gt;可以用最少的投资获得接近于大型主机的性能。&lt;/p&gt;
    
    </summary>
    
      <category term="Nginx" scheme="heibai.site/categories/Nginx/"/>
    
    
      <category term="Nginx" scheme="heibai.site/tags/Nginx/"/>
    
      <category term="负载均衡" scheme="heibai.site/tags/%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
    
  </entry>
  
  <entry>
    <title>Linux系统LVM扩容</title>
    <link href="heibai.site/2018/12/05/Linux%E7%B3%BB%E7%BB%9FLVM%E6%89%A9%E5%AE%B9/"/>
    <id>heibai.site/2018/12/05/Linux系统LVM扩容/</id>
    <published>2018-12-05T14:14:16.000Z</published>
    <updated>2019-03-22T18:25:45.160Z</updated>
    
    <content type="html"><![CDATA[<p>摘要：</p><p>前几天客户给了生产服务器，发现分区并没有要求的那么大，后来发现有硬盘没有分好区，系统lvm扩容步骤简要记录一下</p><h5 id="查看分区列表"><a href="#查看分区列表" class="headerlink" title="查看分区列表"></a>查看分区列表</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l</span><br></pre></td></tr></table></figure><h5 id="fdisk创建一个-dev-vda3分区"><a href="#fdisk创建一个-dev-vda3分区" class="headerlink" title="fdisk创建一个/dev/vda3分区"></a>fdisk创建一个/dev/vda3分区</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk /dev/vda3</span><br></pre></td></tr></table></figure><a id="more"></a><h5 id="重读分区"><a href="#重读分区" class="headerlink" title="重读分区"></a>重读分区</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">partprobe</span><br></pre></td></tr></table></figure><h5 id="格式化分区"><a href="#格式化分区" class="headerlink" title="格式化分区"></a>格式化分区</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkfs -t ext4 /dev/vda3</span><br></pre></td></tr></table></figure><h5 id="创建一个PV物理卷"><a href="#创建一个PV物理卷" class="headerlink" title="创建一个PV物理卷"></a>创建一个PV物理卷</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pvcreate /dev/vda3</span><br></pre></td></tr></table></figure><h5 id="把PV物理卷加入到VG逻辑卷组里"><a href="#把PV物理卷加入到VG逻辑卷组里" class="headerlink" title="把PV物理卷加入到VG逻辑卷组里"></a>把PV物理卷加入到VG逻辑卷组里</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vgextend cl /dev/vda3</span><br></pre></td></tr></table></figure><h5 id="扩展LV逻辑卷的空间"><a href="#扩展LV逻辑卷的空间" class="headerlink" title="扩展LV逻辑卷的空间"></a>扩展LV逻辑卷的空间</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lvextend -l +100%FREE /dev/mapper/cl-root</span><br></pre></td></tr></table></figure><h5 id="刷新分区大小"><a href="#刷新分区大小" class="headerlink" title="刷新分区大小"></a>刷新分区大小</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xfs_growfs  /dev/mapper/cl-root</span><br></pre></td></tr></table></figure><h5 id="查看分区"><a href="#查看分区" class="headerlink" title="查看分区"></a>查看分区</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df -h</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;摘要：&lt;/p&gt;
&lt;p&gt;前几天客户给了生产服务器，发现分区并没有要求的那么大，后来发现有硬盘没有分好区，系统lvm扩容步骤简要记录一下&lt;/p&gt;
&lt;h5 id=&quot;查看分区列表&quot;&gt;&lt;a href=&quot;#查看分区列表&quot; class=&quot;headerlink&quot; title=&quot;查看分区列表&quot;&gt;&lt;/a&gt;查看分区列表&lt;/h5&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;fdisk -l&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&quot;fdisk创建一个-dev-vda3分区&quot;&gt;&lt;a href=&quot;#fdisk创建一个-dev-vda3分区&quot; class=&quot;headerlink&quot; title=&quot;fdisk创建一个/dev/vda3分区&quot;&gt;&lt;/a&gt;fdisk创建一个/dev/vda3分区&lt;/h5&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;fdisk /dev/vda3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="Linux" scheme="heibai.site/categories/Linux/"/>
    
    
      <category term="lvm" scheme="heibai.site/tags/lvm/"/>
    
  </entry>
  
  <entry>
    <title>Centos7编译安装MySql5.7</title>
    <link href="heibai.site/2018/10/19/Centos7%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85MySql5-7/"/>
    <id>heibai.site/2018/10/19/Centos7编译安装MySql5-7/</id>
    <published>2018-10-19T13:50:09.000Z</published>
    <updated>2019-03-22T18:25:45.147Z</updated>
    
    <content type="html"><![CDATA[<h5 id="查看系统版本"><a href="#查看系统版本" class="headerlink" title="查看系统版本"></a>查看系统版本</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/centos-release</span><br><span class="line">CentOS Linux release 7.5.1804 (Core)</span><br></pre></td></tr></table></figure><h5 id="安装所需依赖"><a href="#安装所需依赖" class="headerlink" title="安装所需依赖"></a>安装所需依赖</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc cmake make gcc-c++ ncurses-devel openssl-devel bison ncurses chkconfig lsof</span><br></pre></td></tr></table></figure><a id="more"></a><h5 id="卸载系统自带Mariadb及删除遗留的配置文件"><a href="#卸载系统自带Mariadb及删除遗留的配置文件" class="headerlink" title="卸载系统自带Mariadb及删除遗留的配置文件"></a>卸载系统自带Mariadb及删除遗留的配置文件</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#查看centos 默认安装的mariadb </span></span><br><span class="line">[root@VM_0_15_centos ~]<span class="comment"># rpm -qa | grep mariadb</span></span><br><span class="line">mariadb-libs-5.5.56-2.el7.x86_64</span><br><span class="line"><span class="comment"># 强制卸载mariadb</span></span><br><span class="line">rpm -e --nodeps mariadb-libs-5.5.56-2.el7.x86_64</span><br><span class="line"><span class="comment">#删除对应的mariadb配置文件</span></span><br><span class="line">rm -rf /etc/my.cnf</span><br></pre></td></tr></table></figure><h5 id="下载MySql文件"><a href="#下载MySql文件" class="headerlink" title="下载MySql文件"></a>下载MySql文件</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#进入到/usr/local/src</span></span><br><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/src</span><br><span class="line"><span class="comment">#下载文件（因mysql5.7之后必须要安装boost库，所以这里直接下载带boost的mysql源码）</span></span><br><span class="line">wget https://cdn.mysql.com//Downloads/MySQL-5.7/mysql-boost-5.7.23.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment">#下载成功</span></span><br><span class="line">wget https://cdn.mysql.com//Downloads/MySQL-5.7/mysql-boost-5.7.23.tar.gz</span><br><span class="line">--2018-10-19 22:46:26--  https://cdn.mysql.com//Downloads/MySQL-5.7/mysql-boost-5.7.23.tar.gz</span><br><span class="line">Resolving cdn.mysql.com (cdn.mysql.com)... 23.56.25.233</span><br><span class="line">Connecting to cdn.mysql.com (cdn.mysql.com)|23.56.25.233|:443... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 49025014 (47M) [application/x-tar-gz]</span><br><span class="line">Saving to: ‘mysql-boost-5.7.23.tar.gz’</span><br><span class="line"></span><br><span class="line">100%[==============================================================================================&gt;] 49,025,014   523KB/s   <span class="keyword">in</span> 64s    </span><br><span class="line"></span><br><span class="line">2018-10-19 22:47:47 (747 KB/s) - ‘mysql-boost-5.7.23.tar.gz’ saved [49025014/49025014]</span><br><span class="line"></span><br><span class="line"><span class="comment">#解压文件</span></span><br><span class="line">tar zxvf mysql-boost-5.7.23.tar.gz</span><br><span class="line"><span class="comment">#进入目录</span></span><br><span class="line"><span class="built_in">cd</span> mysql-5.7.23</span><br><span class="line"><span class="comment">#编译参数</span></span><br><span class="line">cmake -DCMAKE_INSTALL_PREFIX=/usr/<span class="built_in">local</span>/mysql -DMYSQL_DATADIR=/usr/<span class="built_in">local</span>/mysql/data -DSYSCONFDIR=/etc -DWITH_MYISAM_STORAGE_ENGINE=1 -DWITH_INNOBASE_STORAGE_ENGINE=1 -DWITH_ARCHIVE_STORAGE_ENGINE=1 -DWITH_MEMORY_STORAGE_ENGINE=1 -DWITH_READLINE=1 -DMYSQL_UNIX_ADDR=/usr/<span class="built_in">local</span>/mysql/mysql.sock -DMYSQL_TCP_PORT=3306 -DENABLED_LOCAL_INFILE=1 -DENABLE_DOWNLOADS=1 -DWITH_PARTITION_STORAGE_ENGINE=1 -DEXTRA_CHARSETS=all -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci -DWITH_DEBUG=0 -DMYSQL_MAINTAINER_MODE=0 -DWITH_SSL:STRING=bundled -DWITH_ZLIB:STRING=bundled -DWITH_BOOST=boost</span><br><span class="line"></span><br><span class="line"><span class="comment">#初始化完成</span></span><br><span class="line"></span><br><span class="line">-- CMAKE_BUILD_TYPE: RelWithDebInfo</span><br><span class="line">-- COMPILE_DEFINITIONS: _GNU_SOURCE;_FILE_OFFSET_BITS=64;HAVE_CONFIG_H;HAVE_LIBEVENT1</span><br><span class="line">-- CMAKE_C_FLAGS:  -Wall -Wextra -Wformat-security -Wvla -Wwrite-strings -Wdeclaration-after-statement</span><br><span class="line">-- CMAKE_CXX_FLAGS:  -Wall -Wextra -Wformat-security -Wvla -Woverloaded-virtual -Wno-unused-parameter</span><br><span class="line">-- CMAKE_C_LINK_FLAGS: </span><br><span class="line">-- CMAKE_CXX_LINK_FLAGS: </span><br><span class="line">-- CMAKE_C_FLAGS_RELWITHDEBINFO: -O3 -g -fabi-version=2 -fno-omit-frame-pointer -fno-strict-aliasing -DDBUG_OFF</span><br><span class="line">-- CMAKE_CXX_FLAGS_RELWITHDEBINFO: -O3 -g -fabi-version=2 -fno-omit-frame-pointer -fno-strict-aliasing -DDBUG_OFF</span><br><span class="line">-- Configuring <span class="keyword">done</span></span><br><span class="line">-- Generating <span class="keyword">done</span></span><br><span class="line">-- Build files have been written to: /usr/<span class="built_in">local</span>/src/mysql-5.7.23</span><br></pre></td></tr></table></figure><h5 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><h5 id="添加mysql用户和用户组"><a href="#添加mysql用户和用户组" class="headerlink" title="添加mysql用户和用户组"></a>添加mysql用户和用户组</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">groupadd mysql</span><br><span class="line">useradd mysql -g mysql -M -s /sbin/nologin</span><br></pre></td></tr></table></figure><h5 id="给mysql用户授权mysql-文件夹"><a href="#给mysql用户授权mysql-文件夹" class="headerlink" title="给mysql用户授权mysql 文件夹"></a>给mysql用户授权mysql 文件夹</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chown -R mysql:mysql /usr/<span class="built_in">local</span>/mysql/</span><br></pre></td></tr></table></figure><h5 id="拷贝启动文件"><a href="#拷贝启动文件" class="headerlink" title="拷贝启动文件"></a>拷贝启动文件</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/<span class="built_in">local</span>/mysql/support-files/mysql.server /etc/init.d/</span><br></pre></td></tr></table></figure><h5 id="初始化数据库"><a href="#初始化数据库" class="headerlink" title="初始化数据库"></a>初始化数据库</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用-initialize会生成随机密码，使用-initialize-insecure生成空密码，这里选择生成空密码。</span></span><br><span class="line">/usr/<span class="built_in">local</span>/mysql/bin/mysqld --initialize-insecure --user=mysql</span><br></pre></td></tr></table></figure><h5 id="启动MySql"><a href="#启动MySql" class="headerlink" title="启动MySql"></a>启动MySql</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">启动MySql</span></span><br><span class="line">/etc/init.d/mysql.server start</span><br><span class="line">Starting MySQL.Logging to '/usr/local/mysql/data/VM_0_15_centos.err'.</span><br><span class="line">SUCCESS!</span><br></pre></td></tr></table></figure><h5 id="添加至环境变量"><a href="#添加至环境变量" class="headerlink" title="添加至环境变量"></a>添加至环境变量</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">使其永久生效，把安装目录添加至环境变量</span></span><br><span class="line">vim /etc/profile</span><br><span class="line"><span class="meta">#</span><span class="bash">文件最后一行添加进去</span></span><br><span class="line">export PATH=$PATH:/usr/local/mysql/bin</span><br><span class="line"><span class="meta">#</span><span class="bash">马上生效</span></span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><h5 id="登陆mysql"><a href="#登陆mysql" class="headerlink" title="登陆mysql"></a>登陆mysql</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure><h5 id="修改密码"><a href="#修改密码" class="headerlink" title="修改密码"></a>修改密码</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">查看数据库</span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show databases;</span></span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br><span class="line"><span class="meta">#</span><span class="bash">修改root密码为123456</span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> <span class="built_in">set</span> password <span class="keyword">for</span> root@localhost = password(<span class="string">'123456'</span>);</span></span><br><span class="line">Query OK, 0 rows affected, 1 warning (0.00 sec)</span><br><span class="line"><span class="meta">#</span><span class="bash">退出mysql，重新登陆生效</span></span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> <span class="built_in">exit</span></span></span><br><span class="line">Bye</span><br></pre></td></tr></table></figure><p>注意事项：</p><p>​                MySql5.7.18之后版本不再提供my.cnf 配置文件</p><p>​           </p>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;查看系统版本&quot;&gt;&lt;a href=&quot;#查看系统版本&quot; class=&quot;headerlink&quot; title=&quot;查看系统版本&quot;&gt;&lt;/a&gt;查看系统版本&lt;/h5&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cat /etc/centos-release&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;CentOS Linux release 7.5.1804 (Core)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h5 id=&quot;安装所需依赖&quot;&gt;&lt;a href=&quot;#安装所需依赖&quot; class=&quot;headerlink&quot; title=&quot;安装所需依赖&quot;&gt;&lt;/a&gt;安装所需依赖&lt;/h5&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;yum -y install gcc cmake make gcc-c++ ncurses-devel openssl-devel bison ncurses chkconfig lsof&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="MySql" scheme="heibai.site/categories/MySql/"/>
    
    
      <category term="MySql" scheme="heibai.site/tags/MySql/"/>
    
  </entry>
  
  <entry>
    <title>Nginx配置https</title>
    <link href="heibai.site/2018/09/24/Nginx%E9%85%8D%E7%BD%AEhttps/"/>
    <id>heibai.site/2018/09/24/Nginx配置https/</id>
    <published>2018-09-24T02:58:56.000Z</published>
    <updated>2019-03-22T18:25:45.260Z</updated>
    
    <content type="html"><![CDATA[<h5 id="Https简介"><a href="#Https简介" class="headerlink" title="Https简介"></a>Https简介</h5><p>  HTTPS（全称：Hyper Text Transfer Protocol over Secure Socket Layer），是以安全为目标的<a href="https://baike.baidu.com/item/HTTP" target="_blank" rel="noopener">HTTP</a>通道，简单讲是HTTP的安全版。即HTTP下加入SSL层，HTTPS的安全基础是SSL，因此加密的详细内容就需要SSL。 它是一个URI scheme（抽象标识符体系），句法类同<a href="https://baike.baidu.com/item/http" target="_blank" rel="noopener">http</a>:体系。用于安全的HTTP数据传输。https:URL表明它使用了HTTP，但HTTPS存在不同于HTTP的默认<a href="https://baike.baidu.com/item/%E7%AB%AF%E5%8F%A3/103505" target="_blank" rel="noopener">端口</a>及一个加密/身份验证层（在HTTP与TCP之间）。这个系统的最初研发由<a href="https://baike.baidu.com/item/%E7%BD%91%E6%99%AF" target="_blank" rel="noopener">网景</a>公司(Netscape)进行，并内置于其浏览器Netscape Navigator中，提供了身份验证与加密<a href="https://baike.baidu.com/item/%E9%80%9A%E8%AE%AF/396194" target="_blank" rel="noopener">通讯</a>方法。</p><h5 id="购买或申请证书"><a href="#购买或申请证书" class="headerlink" title="购买或申请证书"></a>购买或申请证书</h5><p>  有免费1年的单域名证书 也有多域名的，自己去云服务商购买</p><p>把申请完的证书下载，然后传到对应服务器的任意位置，建议在nginx的安装目录下，新建一个文件夹 ,记录下文件路径。<br><a id="more"></a></p><h5 id="Nginx-https配置"><a href="#Nginx-https配置" class="headerlink" title="Nginx https配置"></a>Nginx https配置</h5><p>找到对应的nginx  站点配置文件（我这里为单独的虚拟主机站点）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name   heibi.site;</span><br><span class="line">        root   /www/heibai;</span><br><span class="line">       index  test.html index.php index.html index.htm;</span><br><span class="line">        charset      utf-8;</span><br><span class="line">       access_log  /data/logs/gwaccess.log main;</span><br><span class="line">       error_log   /data/logs/gwerror.log error;</span><br></pre></td></tr></table></figure><p>添加一段nginx配置https的文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">        listen       <span class="number">80</span>;</span><br><span class="line">        server_name   heibai.site;</span><br><span class="line">       <span class="comment"># root   /www/heibai;</span></span><br><span class="line">       <span class="comment"># index  test.html index.php index.html index.htm;</span></span><br><span class="line">        charset      utf<span class="number">-8</span>;</span><br><span class="line">       access_log  /data/logs/gwaccess.log main;</span><br><span class="line">       error_log   /data/logs/gwerror.log error;</span><br><span class="line">       rewrite ^/(.*) https://heibai.site/$<span class="number">1</span> permanent;</span><br><span class="line">      &#125; <span class="comment">#80端口转发到443，访问网站直接跳转到https</span></span><br><span class="line">     </span><br><span class="line">server &#123;</span><br><span class="line">   listen       <span class="number">443</span>;<span class="comment">#端口</span></span><br><span class="line">    server_name heibai.site;<span class="comment">#域名</span></span><br><span class="line">    ssl on;<span class="comment">#开启ssl</span></span><br><span class="line">    root   /www/mx_admin;<span class="comment">#站点根目录</span></span><br><span class="line">    index  test.html index.php index.html index.htm;</span><br><span class="line">    ssl_certificate   /data/ssl/<span class="number">215009961500297.</span>pem;</span><br><span class="line">    ssl_certificate_key /data/ssl/<span class="number">215009961500297.</span>key;</span><br><span class="line">    ssl_session_timeout <span class="number">5</span>m;</span><br><span class="line">    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">    ssl_protocols TLSv1 TLSv1<span class="number">.1</span> TLSv1<span class="number">.2</span>;</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br></pre></td></tr></table></figure><p>修改完成，检查nginx语法是否有问题用</p><p>/usr/local/nginx/sbin/nginx -t</p><h5 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h5><p>1.防火墙443端口和80端口一定要打开</p><p>2.配置443端口 要把80端口的网站根目录注释掉，不然配置好了就是nginx默认页面</p><p>3.Nginx需要开启ssl模块</p>]]></content>
    
    <summary type="html">
    
      &lt;h5 id=&quot;Https简介&quot;&gt;&lt;a href=&quot;#Https简介&quot; class=&quot;headerlink&quot; title=&quot;Https简介&quot;&gt;&lt;/a&gt;Https简介&lt;/h5&gt;&lt;p&gt;  HTTPS（全称：Hyper Text Transfer Protocol over Secure Socket Layer），是以安全为目标的&lt;a href=&quot;https://baike.baidu.com/item/HTTP&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;HTTP&lt;/a&gt;通道，简单讲是HTTP的安全版。即HTTP下加入SSL层，HTTPS的安全基础是SSL，因此加密的详细内容就需要SSL。 它是一个URI scheme（抽象标识符体系），句法类同&lt;a href=&quot;https://baike.baidu.com/item/http&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http&lt;/a&gt;:体系。用于安全的HTTP数据传输。https:URL表明它使用了HTTP，但HTTPS存在不同于HTTP的默认&lt;a href=&quot;https://baike.baidu.com/item/%E7%AB%AF%E5%8F%A3/103505&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;端口&lt;/a&gt;及一个加密/身份验证层（在HTTP与TCP之间）。这个系统的最初研发由&lt;a href=&quot;https://baike.baidu.com/item/%E7%BD%91%E6%99%AF&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;网景&lt;/a&gt;公司(Netscape)进行，并内置于其浏览器Netscape Navigator中，提供了身份验证与加密&lt;a href=&quot;https://baike.baidu.com/item/%E9%80%9A%E8%AE%AF/396194&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;通讯&lt;/a&gt;方法。&lt;/p&gt;
&lt;h5 id=&quot;购买或申请证书&quot;&gt;&lt;a href=&quot;#购买或申请证书&quot; class=&quot;headerlink&quot; title=&quot;购买或申请证书&quot;&gt;&lt;/a&gt;购买或申请证书&lt;/h5&gt;&lt;p&gt;  有免费1年的单域名证书 也有多域名的，自己去云服务商购买&lt;/p&gt;
&lt;p&gt;把申请完的证书下载，然后传到对应服务器的任意位置，建议在nginx的安装目录下，新建一个文件夹 ,记录下文件路径。&lt;br&gt;
    
    </summary>
    
      <category term="Nginx" scheme="heibai.site/categories/Nginx/"/>
    
    
      <category term="Nginx" scheme="heibai.site/tags/Nginx/"/>
    
      <category term="https" scheme="heibai.site/tags/https/"/>
    
  </entry>
  
  <entry>
    <title>MySql保留最近5天备份</title>
    <link href="heibai.site/2018/09/16/MySql%E4%BF%9D%E7%95%99%E6%9C%80%E8%BF%915%E5%A4%A9%E5%A4%87%E4%BB%BD/"/>
    <id>heibai.site/2018/09/16/MySql保留最近5天备份/</id>
    <published>2018-09-16T07:15:43.000Z</published>
    <updated>2019-03-22T18:25:45.161Z</updated>
    
    <content type="html"><![CDATA[<h4 id="进入备份目录"><a href="#进入备份目录" class="headerlink" title="进入备份目录"></a>进入备份目录</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /mysqlbackup</span><br></pre></td></tr></table></figure><h4 id="编写shell脚本"><a href="#编写shell脚本" class="headerlink" title="编写shell脚本"></a>编写shell脚本</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi clean.sh</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">find /mysqlbackup  -mtime +4  -name "*.sql" -exec rm -rf &#123;&#125; \;</span><br></pre></td></tr></table></figure><a id="more"></a><p>删除该目录下5天以前的以sql后缀结尾的文件</p><h4 id="添加执行权限"><a href="#添加执行权限" class="headerlink" title="添加执行权限"></a>添加执行权限</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 clean.sh</span><br></pre></td></tr></table></figure><h4 id="定时任务"><a href="#定时任务" class="headerlink" title="定时任务"></a>定时任务</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br><span class="line">0 6 * * * /backup.sh</span><br></pre></td></tr></table></figure><p>每天凌晨6点执行一次</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;进入备份目录&quot;&gt;&lt;a href=&quot;#进入备份目录&quot; class=&quot;headerlink&quot; title=&quot;进入备份目录&quot;&gt;&lt;/a&gt;进入备份目录&lt;/h4&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cd /mysqlbackup&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;编写shell脚本&quot;&gt;&lt;a href=&quot;#编写shell脚本&quot; class=&quot;headerlink&quot; title=&quot;编写shell脚本&quot;&gt;&lt;/a&gt;编写shell脚本&lt;/h4&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vi clean.sh&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt;!/bin/bash&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;find /mysqlbackup  -mtime +4  -name &quot;*.sql&quot; -exec rm -rf &amp;#123;&amp;#125; \;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="MySql" scheme="heibai.site/categories/MySql/"/>
    
    
      <category term="MySql" scheme="heibai.site/tags/MySql/"/>
    
  </entry>
  
  <entry>
    <title>MySql数据库每天定时自动备份</title>
    <link href="heibai.site/2018/09/16/MySql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%AF%8F%E5%A4%A9%E5%AE%9A%E6%97%B6%E8%87%AA%E5%8A%A8%E5%A4%87%E4%BB%BD/"/>
    <id>heibai.site/2018/09/16/MySql数据库每天定时自动备份/</id>
    <published>2018-09-16T02:03:08.000Z</published>
    <updated>2019-03-22T18:25:45.183Z</updated>
    
    <content type="html"><![CDATA[<h4 id="创建备份目录"><a href="#创建备份目录" class="headerlink" title="创建备份目录"></a>创建备份目录</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir /mysqlbackup</span><br><span class="line"><span class="built_in">cd</span> /mysqlbackup</span><br></pre></td></tr></table></figure><h4 id="编写shell脚本"><a href="#编写shell脚本" class="headerlink" title="编写shell脚本"></a>编写shell脚本</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vi backup.sh</span><br><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">dd=$(date +"%Y-%m-%d")</span><br><span class="line">usr/local/mysql/bin/mysqldump -uusername -ppassword databasename &gt;/mysqlbackup/$dd-databasename.sql;</span><br></pre></td></tr></table></figure><a id="more"></a><p>注意：</p><p>1.mysqldump路径需要写绝对路径，直接执行命令，备份能够成功，但是脚本里面不写绝对路径，备份出来的会是空文件；</p><p>2.username替换为用户名，一般为root；</p><p>3.password为密码；</p><p>4.databasename为要备份的数据库名称。</p><h4 id="添加执行权限"><a href="#添加执行权限" class="headerlink" title="添加执行权限"></a>添加执行权限</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 777 backup.sh</span><br></pre></td></tr></table></figure><h4 id="定时任务"><a href="#定时任务" class="headerlink" title="定时任务"></a>定时任务</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br><span class="line">0 5 * * * /backup.sh</span><br></pre></td></tr></table></figure><p>表示每天凌晨5点自动执行这个脚本，完成备份。</p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;创建备份目录&quot;&gt;&lt;a href=&quot;#创建备份目录&quot; class=&quot;headerlink&quot; title=&quot;创建备份目录&quot;&gt;&lt;/a&gt;创建备份目录&lt;/h4&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mkdir /mysqlbackup&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; /mysqlbackup&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;编写shell脚本&quot;&gt;&lt;a href=&quot;#编写shell脚本&quot; class=&quot;headerlink&quot; title=&quot;编写shell脚本&quot;&gt;&lt;/a&gt;编写shell脚本&lt;/h4&gt;&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;vi backup.sh&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;meta&quot;&gt;#&lt;/span&gt;&lt;span class=&quot;bash&quot;&gt;!/bin/bash&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dd=$(date +&quot;%Y-%m-%d&quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;usr/local/mysql/bin/mysqldump -uusername -ppassword databasename &amp;gt;/mysqlbackup/$dd-databasename.sql;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
      <category term="MySql" scheme="heibai.site/categories/MySql/"/>
    
    
      <category term="MySql" scheme="heibai.site/tags/MySql/"/>
    
  </entry>
  
  <entry>
    <title>同步Android源码清除缓存</title>
    <link href="heibai.site/2018/04/14/%E5%90%8C%E6%AD%A5Android%E6%BA%90%E7%A0%81%E6%B8%85%E9%99%A4%E7%BC%93%E5%AD%98/"/>
    <id>heibai.site/2018/04/14/同步Android源码清除缓存/</id>
    <published>2018-04-14T03:03:58.000Z</published>
    <updated>2019-03-22T18:25:45.297Z</updated>
    
    <content type="html"><![CDATA[<h4 id="同步Android源码清除缓存："><a href="#同步Android源码清除缓存：" class="headerlink" title="同步Android源码清除缓存："></a>同步Android源码清除缓存：</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find .repo/ -name <span class="string">"*tmp_pack*"</span> | xargs rm -rvf</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;同步Android源码清除缓存：&quot;&gt;&lt;a href=&quot;#同步Android源码清除缓存：&quot; class=&quot;headerlink&quot; title=&quot;同步Android源码清除缓存：&quot;&gt;&lt;/a&gt;同步Android源码清除缓存：&lt;/h4&gt;&lt;figure class=&quot;hi
      
    
    </summary>
    
      <category term="Linux" scheme="heibai.site/categories/Linux/"/>
    
    
      <category term="Android" scheme="heibai.site/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>Windows 修改远程端口号</title>
    <link href="heibai.site/2018/04/14/Windows-%E4%BF%AE%E6%94%B9%E8%BF%9C%E7%A8%8B%E7%AB%AF%E5%8F%A3%E5%8F%B7/"/>
    <id>heibai.site/2018/04/14/Windows-修改远程端口号/</id>
    <published>2018-04-14T02:47:58.000Z</published>
    <updated>2019-03-22T18:25:45.288Z</updated>
    
    <content type="html"><![CDATA[<h4 id="Win-R-运行regedit-注册表"><a href="#Win-R-运行regedit-注册表" class="headerlink" title="Win+R 运行regedit(注册表)"></a>Win+R 运行regedit(注册表)</h4><p>点击HKEY_LOCAL_MACHINE/SYSTEM/CurrentConrtolset/Control/Terminal Server/Wds/rdpwd/Tds/tcp portNumber(远程端口号，默认3389)</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;Win-R-运行regedit-注册表&quot;&gt;&lt;a href=&quot;#Win-R-运行regedit-注册表&quot; class=&quot;headerlink&quot; title=&quot;Win+R 运行regedit(注册表)&quot;&gt;&lt;/a&gt;Win+R 运行regedit(注册表)&lt;/h4&gt;&lt;p&gt;
      
    
    </summary>
    
      <category term="Windows" scheme="heibai.site/categories/Windows/"/>
    
    
      <category term="Windows" scheme="heibai.site/tags/Windows/"/>
    
  </entry>
  
  <entry>
    <title>Linux防火墙</title>
    <link href="heibai.site/2018/04/14/Linux%E9%98%B2%E7%81%AB%E5%A2%99/"/>
    <id>heibai.site/2018/04/14/Linux防火墙/</id>
    <published>2018-04-14T02:05:39.000Z</published>
    <updated>2019-03-22T18:25:45.159Z</updated>
    
    <content type="html"><![CDATA[<h4 id="centos7"><a href="#centos7" class="headerlink" title="centos7"></a>centos7</h4><h4 id="通过防火墙"><a href="#通过防火墙" class="headerlink" title="通过防火墙"></a>通过防火墙</h4><p>80端口</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=80/tcp --permanent</span><br></pre></td></tr></table></figure><p>443端口<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=443/tcp --permanent</span><br></pre></td></tr></table></figure></p><a id="more"></a><h4 id="重启防火墙"><a href="#重启防火墙" class="headerlink" title="重启防火墙"></a>重启防火墙</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart firewalld.service</span><br></pre></td></tr></table></figure><h4 id="centos6"><a href="#centos6" class="headerlink" title="centos6"></a>centos6</h4><p>查询防火墙状态:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service   iptables status</span><br></pre></td></tr></table></figure><p>停止防火墙:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service   iptables stop</span><br></pre></td></tr></table></figure></p><p>启动防火墙:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service   iptables start</span><br></pre></td></tr></table></figure></p><p>重启防火墙:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service   iptables restart</span><br></pre></td></tr></table></figure></p><p>永久关闭防火墙:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig   iptables off</span><br></pre></td></tr></table></figure></p><p>永久关闭后启用:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chkconfig   iptables on</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;h4 id=&quot;centos7&quot;&gt;&lt;a href=&quot;#centos7&quot; class=&quot;headerlink&quot; title=&quot;centos7&quot;&gt;&lt;/a&gt;centos7&lt;/h4&gt;&lt;h4 id=&quot;通过防火墙&quot;&gt;&lt;a href=&quot;#通过防火墙&quot; class=&quot;headerlink&quot; title=&quot;通过防火墙&quot;&gt;&lt;/a&gt;通过防火墙&lt;/h4&gt;&lt;p&gt;80端口&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;firewall-cmd --zone=public --add-port=80/tcp --permanent&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;443端口&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;firewall-cmd --zone=public --add-port=443/tcp --permanent&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Linux" scheme="heibai.site/categories/Linux/"/>
    
    
      <category term="Linux" scheme="heibai.site/tags/Linux/"/>
    
  </entry>
  
  <entry>
    <title>Hello World!</title>
    <link href="heibai.site/2018/04/11/Hello-World-0/"/>
    <id>heibai.site/2018/04/11/Hello-World-0/</id>
    <published>2018-04-11T14:21:19.000Z</published>
    <updated>2019-03-22T18:25:45.153Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
</feed>
